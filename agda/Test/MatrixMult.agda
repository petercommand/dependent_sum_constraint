{-# OPTIONS --prop #-}
module Test.MatrixMult where

open import Data.Bool renaming (_≟_ to _≟B_)
open import Data.Field.Prime
open import Data.Fin hiding (_≟_)
open import Data.List hiding (foldl)
open import Data.Nat hiding (_≟_)
open import Data.Nat.Primality
open import Data.Nat.Properties
open import Data.Nat.Show renaming (show to showℕ)
open import Data.Product hiding (map)
open import Data.Unit hiding (_≟_)
open import Data.Vec hiding (_>>=_; map; _++_)

open import Relation.Binary.PropositionalEquality
open import Relation.Nullary

N = 21888242871839275222246405745257275088548364400416034343698204186575808495617

postulate
  nPrime : Prime N

FF = PrimeField N
FField = isField N nPrime
FFinite = isFinite N nPrime

open import Language.Common


module Test where
  open import Language.Source FF FFinite (λ x → showℕ (PrimeField.elem x))
  open import Language.Source.Utils FF FFinite (λ x → showℕ (PrimeField.elem x))
  open import Language.TySize FF FFinite
  open import Language.Universe FF
  
  `Matrix : U → ℕ → ℕ → U
  `Matrix u m n = `Vec (`Vec u n) m
  
  getMatrix : ∀ {u} {m} {n} → Source (`Matrix u m n) → Fin m → Fin n → Source u
  getMatrix s m n = getV (getV s m) n

  open import Function

  test : S-Monad (Source (`Matrix `Base 10 20))
  test = do
    m₁ ← newI (`Matrix `Base 10 30)
    m₂ ← newI (`Matrix `Base 30 20)
    m₃ ← new (`Matrix `Base 10 20)
    iterM 10 (λ m → do
       iterM 20 (λ n → do
          vec ← iterM 30 (λ o → do
            let fstElem = getMatrix m₁ m o
                sndElem = getMatrix m₂ o n
            return (Mul fstElem sndElem))
          let setElem = getMatrix m₃ m n
          let r = foldl (const (Source `Base)) Mul (Ind refl (0 ∷ [])) vec
          assertEq r setElem))
    return m₃
open Test

open import Compile.Generate FF FField FFinite (λ x → showℕ (PrimeField.elem x)) PrimeField.elem (fieldElem nPrime)

open import IO

main = let inputAss = (1 , 3) ∷ (2 , 5) ∷ (3 , 7) ∷ (4 , 9) ∷ (5 , 11) ∷ (6 , 13) ∷ (7 , 15) ∷ (8 , 17) ∷ (9 , 19) ∷ (10 , 21) ∷ (11 , 23) ∷ (12 , 25) ∷ (13 , 27) ∷ (14 , 29) ∷ (15 , 31) ∷ (16 , 33) ∷ (17 , 35) ∷ (18 , 37) ∷ (19 , 39) ∷ (20 , 41) ∷ (21 , 43) ∷ (22 , 45) ∷ (23 , 47) ∷ (24 , 49) ∷ (25 , 51) ∷ (26 , 53) ∷ (27 , 55) ∷ (28 , 57) ∷ (29 , 59) ∷ (30 , 61) ∷ (31 , 63) ∷ (32 , 65) ∷ (33 , 67) ∷ (34 , 69) ∷ (35 , 71) ∷ (36 , 73) ∷ (37 , 75) ∷ (38 , 77) ∷ (39 , 79) ∷ (40 , 81) ∷ (41 , 83) ∷ (42 , 85) ∷ (43 , 87) ∷ (44 , 89) ∷ (45 , 91) ∷ (46 , 93) ∷ (47 , 95) ∷ (48 , 97) ∷ (49 , 99) ∷ (50 , 101) ∷ (51 , 103) ∷ (52 , 105) ∷ (53 , 107) ∷ (54 , 109) ∷ (55 , 111) ∷ (56 , 113) ∷ (57 , 115) ∷ (58 , 117) ∷ (59 , 119) ∷ (60 , 121) ∷ (61 , 123) ∷ (62 , 125) ∷ (63 , 127) ∷ (64 , 129) ∷ (65 , 131) ∷ (66 , 133) ∷ (67 , 135) ∷ (68 , 137) ∷ (69 , 139) ∷ (70 , 141) ∷ (71 , 143) ∷ (72 , 145) ∷ (73 , 147) ∷ (74 , 149) ∷ (75 , 151) ∷ (76 , 153) ∷ (77 , 155) ∷ (78 , 157) ∷ (79 , 159) ∷ (80 , 161) ∷ (81 , 163) ∷ (82 , 165) ∷ (83 , 167) ∷ (84 , 169) ∷ (85 , 171) ∷ (86 , 173) ∷ (87 , 175) ∷ (88 , 177) ∷ (89 , 179) ∷ (90 , 181) ∷ (91 , 183) ∷ (92 , 185) ∷ (93 , 187) ∷ (94 , 189) ∷ (95 , 191) ∷ (96 , 193) ∷ (97 , 195) ∷ (98 , 197) ∷ (99 , 199) ∷ (100 , 201) ∷ (101 , 203) ∷ (102 , 205) ∷ (103 , 207) ∷ (104 , 209) ∷ (105 , 211) ∷ (106 , 213) ∷ (107 , 215) ∷ (108 , 217) ∷ (109 , 219) ∷ (110 , 221) ∷ (111 , 223) ∷ (112 , 225) ∷ (113 , 227) ∷ (114 , 229) ∷ (115 , 231) ∷ (116 , 233) ∷ (117 , 235) ∷ (118 , 237) ∷ (119 , 239) ∷ (120 , 241) ∷ (121 , 243) ∷ (122 , 245) ∷ (123 , 247) ∷ (124 , 249) ∷ (125 , 251) ∷ (126 , 253) ∷ (127 , 255) ∷ (128 , 257) ∷ (129 , 259) ∷ (130 , 261) ∷ (131 , 263) ∷ (132 , 265) ∷ (133 , 267) ∷ (134 , 269) ∷ (135 , 271) ∷ (136 , 273) ∷ (137 , 275) ∷ (138 , 277) ∷ (139 , 279) ∷ (140 , 281) ∷ (141 , 283) ∷ (142 , 285) ∷ (143 , 287) ∷ (144 , 289) ∷ (145 , 291) ∷ (146 , 293) ∷ (147 , 295) ∷ (148 , 297) ∷ (149 , 299) ∷ (150 , 301) ∷ (151 , 303) ∷ (152 , 305) ∷ (153 , 307) ∷ (154 , 309) ∷ (155 , 311) ∷ (156 , 313) ∷ (157 , 315) ∷ (158 , 317) ∷ (159 , 319) ∷ (160 , 321) ∷ (161 , 323) ∷ (162 , 325) ∷ (163 , 327) ∷ (164 , 329) ∷ (165 , 331) ∷ (166 , 333) ∷ (167 , 335) ∷ (168 , 337) ∷ (169 , 339) ∷ (170 , 341) ∷ (171 , 343) ∷ (172 , 345) ∷ (173 , 347) ∷ (174 , 349) ∷ (175 , 351) ∷ (176 , 353) ∷ (177 , 355) ∷ (178 , 357) ∷ (179 , 359) ∷ (180 , 361) ∷ (181 , 363) ∷ (182 , 365) ∷ (183 , 367) ∷ (184 , 369) ∷ (185 , 371) ∷ (186 , 373) ∷ (187 , 375) ∷ (188 , 377) ∷ (189 , 379) ∷ (190 , 381) ∷ (191 , 383) ∷ (192 , 385) ∷ (193 , 387) ∷ (194 , 389) ∷ (195 , 391) ∷ (196 , 393) ∷ (197 , 395) ∷ (198 , 397) ∷ (199 , 399) ∷ (200 , 401) ∷ (201 , 403) ∷ (202 , 405) ∷ (203 , 407) ∷ (204 , 409) ∷ (205 , 411) ∷ (206 , 413) ∷ (207 , 415) ∷ (208 , 417) ∷ (209 , 419) ∷ (210 , 421) ∷ (211 , 423) ∷ (212 , 425) ∷ (213 , 427) ∷ (214 , 429) ∷ (215 , 431) ∷ (216 , 433) ∷ (217 , 435) ∷ (218 , 437) ∷ (219 , 439) ∷ (220 , 441) ∷ (221 , 443) ∷ (222 , 445) ∷ (223 , 447) ∷ (224 , 449) ∷ (225 , 451) ∷ (226 , 453) ∷ (227 , 455) ∷ (228 , 457) ∷ (229 , 459) ∷ (230 , 461) ∷ (231 , 463) ∷ (232 , 465) ∷ (233 , 467) ∷ (234 , 469) ∷ (235 , 471) ∷ (236 , 473) ∷ (237 , 475) ∷ (238 , 477) ∷ (239 , 479) ∷ (240 , 481) ∷ (241 , 483) ∷ (242 , 485) ∷ (243 , 487) ∷ (244 , 489) ∷ (245 , 491) ∷ (246 , 493) ∷ (247 , 495) ∷ (248 , 497) ∷ (249 , 499) ∷ (250 , 501) ∷ (251 , 503) ∷ (252 , 505) ∷ (253 , 507) ∷ (254 , 509) ∷ (255 , 511) ∷ (256 , 513) ∷ (257 , 515) ∷ (258 , 517) ∷ (259 , 519) ∷ (260 , 521) ∷ (261 , 523) ∷ (262 , 525) ∷ (263 , 527) ∷ (264 , 529) ∷ (265 , 531) ∷ (266 , 533) ∷ (267 , 535) ∷ (268 , 537) ∷ (269 , 539) ∷ (270 , 541) ∷ (271 , 543) ∷ (272 , 545) ∷ (273 , 547) ∷ (274 , 549) ∷ (275 , 551) ∷ (276 , 553) ∷ (277 , 555) ∷ (278 , 557) ∷ (279 , 559) ∷ (280 , 561) ∷ (281 , 563) ∷ (282 , 565) ∷ (283 , 567) ∷ (284 , 569) ∷ (285 , 571) ∷ (286 , 573) ∷ (287 , 575) ∷ (288 , 577) ∷ (289 , 579) ∷ (290 , 581) ∷ (291 , 583) ∷ (292 , 585) ∷ (293 , 587) ∷ (294 , 589) ∷ (295 , 591) ∷ (296 , 593) ∷ (297 , 595) ∷ (298 , 597) ∷ (299 , 599) ∷ (300 , 601) ∷ (301 , 3) ∷ (302 , 5) ∷ (303 , 7) ∷ (304 , 9) ∷ (305 , 11) ∷ (306 , 13) ∷ (307 , 15) ∷ (308 , 17) ∷ (309 , 19) ∷ (310 , 21) ∷ (311 , 23) ∷ (312 , 25) ∷ (313 , 27) ∷ (314 , 29) ∷ (315 , 31) ∷ (316 , 33) ∷ (317 , 35) ∷ (318 , 37) ∷ (319 , 39) ∷ (320 , 41) ∷ (321 , 43) ∷ (322 , 45) ∷ (323 , 47) ∷ (324 , 49) ∷ (325 , 51) ∷ (326 , 53) ∷ (327 , 55) ∷ (328 , 57) ∷ (329 , 59) ∷ (330 , 61) ∷ (331 , 63) ∷ (332 , 65) ∷ (333 , 67) ∷ (334 , 69) ∷ (335 , 71) ∷ (336 , 73) ∷ (337 , 75) ∷ (338 , 77) ∷ (339 , 79) ∷ (340 , 81) ∷ (341 , 83) ∷ (342 , 85) ∷ (343 , 87) ∷ (344 , 89) ∷ (345 , 91) ∷ (346 , 93) ∷ (347 , 95) ∷ (348 , 97) ∷ (349 , 99) ∷ (350 , 101) ∷ (351 , 103) ∷ (352 , 105) ∷ (353 , 107) ∷ (354 , 109) ∷ (355 , 111) ∷ (356 , 113) ∷ (357 , 115) ∷ (358 , 117) ∷ (359 , 119) ∷ (360 , 121) ∷ (361 , 123) ∷ (362 , 125) ∷ (363 , 127) ∷ (364 , 129) ∷ (365 , 131) ∷ (366 , 133) ∷ (367 , 135) ∷ (368 , 137) ∷ (369 , 139) ∷ (370 , 141) ∷ (371 , 143) ∷ (372 , 145) ∷ (373 , 147) ∷ (374 , 149) ∷ (375 , 151) ∷ (376 , 153) ∷ (377 , 155) ∷ (378 , 157) ∷ (379 , 159) ∷ (380 , 161) ∷ (381 , 163) ∷ (382 , 165) ∷ (383 , 167) ∷ (384 , 169) ∷ (385 , 171) ∷ (386 , 173) ∷ (387 , 175) ∷ (388 , 177) ∷ (389 , 179) ∷ (390 , 181) ∷ (391 , 183) ∷ (392 , 185) ∷ (393 , 187) ∷ (394 , 189) ∷ (395 , 191) ∷ (396 , 193) ∷ (397 , 195) ∷ (398 , 197) ∷ (399 , 199) ∷ (400 , 201) ∷ (401 , 203) ∷ (402 , 205) ∷ (403 , 207) ∷ (404 , 209) ∷ (405 , 211) ∷ (406 , 213) ∷ (407 , 215) ∷ (408 , 217) ∷ (409 , 219) ∷ (410 , 221) ∷ (411 , 223) ∷ (412 , 225) ∷ (413 , 227) ∷ (414 , 229) ∷ (415 , 231) ∷ (416 , 233) ∷ (417 , 235) ∷ (418 , 237) ∷ (419 , 239) ∷ (420 , 241) ∷ (421 , 243) ∷ (422 , 245) ∷ (423 , 247) ∷ (424 , 249) ∷ (425 , 251) ∷ (426 , 253) ∷ (427 , 255) ∷ (428 , 257) ∷ (429 , 259) ∷ (430 , 261) ∷ (431 , 263) ∷ (432 , 265) ∷ (433 , 267) ∷ (434 , 269) ∷ (435 , 271) ∷ (436 , 273) ∷ (437 , 275) ∷ (438 , 277) ∷ (439 , 279) ∷ (440 , 281) ∷ (441 , 283) ∷ (442 , 285) ∷ (443 , 287) ∷ (444 , 289) ∷ (445 , 291) ∷ (446 , 293) ∷ (447 , 295) ∷ (448 , 297) ∷ (449 , 299) ∷ (450 , 301) ∷ (451 , 303) ∷ (452 , 305) ∷ (453 , 307) ∷ (454 , 309) ∷ (455 , 311) ∷ (456 , 313) ∷ (457 , 315) ∷ (458 , 317) ∷ (459 , 319) ∷ (460 , 321) ∷ (461 , 323) ∷ (462 , 325) ∷ (463 , 327) ∷ (464 , 329) ∷ (465 , 331) ∷ (466 , 333) ∷ (467 , 335) ∷ (468 , 337) ∷ (469 , 339) ∷ (470 , 341) ∷ (471 , 343) ∷ (472 , 345) ∷ (473 , 347) ∷ (474 , 349) ∷ (475 , 351) ∷ (476 , 353) ∷ (477 , 355) ∷ (478 , 357) ∷ (479 , 359) ∷ (480 , 361) ∷ (481 , 363) ∷ (482 , 365) ∷ (483 , 367) ∷ (484 , 369) ∷ (485 , 371) ∷ (486 , 373) ∷ (487 , 375) ∷ (488 , 377) ∷ (489 , 379) ∷ (490 , 381) ∷ (491 , 383) ∷ (492 , 385) ∷ (493 , 387) ∷ (494 , 389) ∷ (495 , 391) ∷ (496 , 393) ∷ (497 , 395) ∷ (498 , 397) ∷ (499 , 399) ∷ (500 , 401) ∷ (501 , 403) ∷ (502 , 405) ∷ (503 , 407) ∷ (504 , 409) ∷ (505 , 411) ∷ (506 , 413) ∷ (507 , 415) ∷ (508 , 417) ∷ (509 , 419) ∷ (510 , 421) ∷ (511 , 423) ∷ (512 , 425) ∷ (513 , 427) ∷ (514 , 429) ∷ (515 , 431) ∷ (516 , 433) ∷ (517 , 435) ∷ (518 , 437) ∷ (519 , 439) ∷ (520 , 441) ∷ (521 , 443) ∷ (522 , 445) ∷ (523 , 447) ∷ (524 , 449) ∷ (525 , 451) ∷ (526 , 453) ∷ (527 , 455) ∷ (528 , 457) ∷ (529 , 459) ∷ (530 , 461) ∷ (531 , 463) ∷ (532 , 465) ∷ (533 , 467) ∷ (534 , 469) ∷ (535 , 471) ∷ (536 , 473) ∷ (537 , 475) ∷ (538 , 477) ∷ (539 , 479) ∷ (540 , 481) ∷ (541 , 483) ∷ (542 , 485) ∷ (543 , 487) ∷ (544 , 489) ∷ (545 , 491) ∷ (546 , 493) ∷ (547 , 495) ∷ (548 , 497) ∷ (549 , 499) ∷ (550 , 501) ∷ (551 , 503) ∷ (552 , 505) ∷ (553 , 507) ∷ (554 , 509) ∷ (555 , 511) ∷ (556 , 513) ∷ (557 , 515) ∷ (558 , 517) ∷ (559 , 519) ∷ (560 , 521) ∷ (561 , 523) ∷ (562 , 525) ∷ (563 , 527) ∷ (564 , 529) ∷ (565 , 531) ∷ (566 , 533) ∷ (567 , 535) ∷ (568 , 537) ∷ (569 , 539) ∷ (570 , 541) ∷ (571 , 543) ∷ (572 , 545) ∷ (573 , 547) ∷ (574 , 549) ∷ (575 , 551) ∷ (576 , 553) ∷ (577 , 555) ∷ (578 , 557) ∷ (579 , 559) ∷ (580 , 561) ∷ (581 , 563) ∷ (582 , 565) ∷ (583 , 567) ∷ (584 , 569) ∷ (585 , 571) ∷ (586 , 573) ∷ (587 , 575) ∷ (588 , 577) ∷ (589 , 579) ∷ (590 , 581) ∷ (591 , 583) ∷ (592 , 585) ∷ (593 , 587) ∷ (594 , 589) ∷ (595 , 591) ∷ (596 , 593) ∷ (597 , 595) ∷ (598 , 597) ∷ (599 , 599) ∷ (600 , 601) ∷ (601 , 603) ∷ (602 , 605) ∷ (603 , 607) ∷ (604 , 609) ∷ (605 , 611) ∷ (606 , 613) ∷ (607 , 615) ∷ (608 , 617) ∷ (609 , 619) ∷ (610 , 621) ∷ (611 , 623) ∷ (612 , 625) ∷ (613 , 627) ∷ (614 , 629) ∷ (615 , 631) ∷ (616 , 633) ∷ (617 , 635) ∷ (618 , 637) ∷ (619 , 639) ∷ (620 , 641) ∷ (621 , 643) ∷ (622 , 645) ∷ (623 , 647) ∷ (624 , 649) ∷ (625 , 651) ∷ (626 , 653) ∷ (627 , 655) ∷ (628 , 657) ∷ (629 , 659) ∷ (630 , 661) ∷ (631 , 663) ∷ (632 , 665) ∷ (633 , 667) ∷ (634 , 669) ∷ (635 , 671) ∷ (636 , 673) ∷ (637 , 675) ∷ (638 , 677) ∷ (639 , 679) ∷ (640 , 681) ∷ (641 , 683) ∷ (642 , 685) ∷ (643 , 687) ∷ (644 , 689) ∷ (645 , 691) ∷ (646 , 693) ∷ (647 , 695) ∷ (648 , 697) ∷ (649 , 699) ∷ (650 , 701) ∷ (651 , 703) ∷ (652 , 705) ∷ (653 , 707) ∷ (654 , 709) ∷ (655 , 711) ∷ (656 , 713) ∷ (657 , 715) ∷ (658 , 717) ∷ (659 , 719) ∷ (660 , 721) ∷ (661 , 723) ∷ (662 , 725) ∷ (663 , 727) ∷ (664 , 729) ∷ (665 , 731) ∷ (666 , 733) ∷ (667 , 735) ∷ (668 , 737) ∷ (669 , 739) ∷ (670 , 741) ∷ (671 , 743) ∷ (672 , 745) ∷ (673 , 747) ∷ (674 , 749) ∷ (675 , 751) ∷ (676 , 753) ∷ (677 , 755) ∷ (678 , 757) ∷ (679 , 759) ∷ (680 , 761) ∷ (681 , 763) ∷ (682 , 765) ∷ (683 , 767) ∷ (684 , 769) ∷ (685 , 771) ∷ (686 , 773) ∷ (687 , 775) ∷ (688 , 777) ∷ (689 , 779) ∷ (690 , 781) ∷ (691 , 783) ∷ (692 , 785) ∷ (693 , 787) ∷ (694 , 789) ∷ (695 , 791) ∷ (696 , 793) ∷ (697 , 795) ∷ (698 , 797) ∷ (699 , 799) ∷ (700 , 801) ∷ (701 , 803) ∷ (702 , 805) ∷ (703 , 807) ∷ (704 , 809) ∷ (705 , 811) ∷ (706 , 813) ∷ (707 , 815) ∷ (708 , 817) ∷ (709 , 819) ∷ (710 , 821) ∷ (711 , 823) ∷ (712 , 825) ∷ (713 , 827) ∷ (714 , 829) ∷ (715 , 831) ∷ (716 , 833) ∷ (717 , 835) ∷ (718 , 837) ∷ (719 , 839) ∷ (720 , 841) ∷ (721 , 843) ∷ (722 , 845) ∷ (723 , 847) ∷ (724 , 849) ∷ (725 , 851) ∷ (726 , 853) ∷ (727 , 855) ∷ (728 , 857) ∷ (729 , 859) ∷ (730 , 861) ∷ (731 , 863) ∷ (732 , 865) ∷ (733 , 867) ∷ (734 , 869) ∷ (735 , 871) ∷ (736 , 873) ∷ (737 , 875) ∷ (738 , 877) ∷ (739 , 879) ∷ (740 , 881) ∷ (741 , 883) ∷ (742 , 885) ∷ (743 , 887) ∷ (744 , 889) ∷ (745 , 891) ∷ (746 , 893) ∷ (747 , 895) ∷ (748 , 897) ∷ (749 , 899) ∷ (750 , 901) ∷ (751 , 903) ∷ (752 , 905) ∷ (753 , 907) ∷ (754 , 909) ∷ (755 , 911) ∷ (756 , 913) ∷ (757 , 915) ∷ (758 , 917) ∷ (759 , 919) ∷ (760 , 921) ∷ (761 , 923) ∷ (762 , 925) ∷ (763 , 927) ∷ (764 , 929) ∷ (765 , 931) ∷ (766 , 933) ∷ (767 , 935) ∷ (768 , 937) ∷ (769 , 939) ∷ (770 , 941) ∷ (771 , 943) ∷ (772 , 945) ∷ (773 , 947) ∷ (774 , 949) ∷ (775 , 951) ∷ (776 , 953) ∷ (777 , 955) ∷ (778 , 957) ∷ (779 , 959) ∷ (780 , 961) ∷ (781 , 963) ∷ (782 , 965) ∷ (783 , 967) ∷ (784 , 969) ∷ (785 , 971) ∷ (786 , 973) ∷ (787 , 975) ∷ (788 , 977) ∷ (789 , 979) ∷ (790 , 981) ∷ (791 , 983) ∷ (792 , 985) ∷ (793 , 987) ∷ (794 , 989) ∷ (795 , 991) ∷ (796 , 993) ∷ (797 , 995) ∷ (798 , 997) ∷ (799 , 999) ∷ (800 , 1001) ∷ (801 , 1003) ∷ (802 , 1005) ∷ (803 , 1007) ∷ (804 , 1009) ∷ (805 , 1011) ∷ (806 , 1013) ∷ (807 , 1015) ∷ (808 , 1017) ∷ (809 , 1019) ∷ (810 , 1021) ∷ (811 , 1023) ∷ (812 , 1025) ∷ (813 , 1027) ∷ (814 , 1029) ∷ (815 , 1031) ∷ (816 , 1033) ∷ (817 , 1035) ∷ (818 , 1037) ∷ (819 , 1039) ∷ (820 , 1041) ∷ (821 , 1043) ∷ (822 , 1045) ∷ (823 , 1047) ∷ (824 , 1049) ∷ (825 , 1051) ∷ (826 , 1053) ∷ (827 , 1055) ∷ (828 , 1057) ∷ (829 , 1059) ∷ (830 , 1061) ∷ (831 , 1063) ∷ (832 , 1065) ∷ (833 , 1067) ∷ (834 , 1069) ∷ (835 , 1071) ∷ (836 , 1073) ∷ (837 , 1075) ∷ (838 , 1077) ∷ (839 , 1079) ∷ (840 , 1081) ∷ (841 , 1083) ∷ (842 , 1085) ∷ (843 , 1087) ∷ (844 , 1089) ∷ (845 , 1091) ∷ (846 , 1093) ∷ (847 , 1095) ∷ (848 , 1097) ∷ (849 , 1099) ∷ (850 , 1101) ∷ (851 , 1103) ∷ (852 , 1105) ∷ (853 , 1107) ∷ (854 , 1109) ∷ (855 , 1111) ∷ (856 , 1113) ∷ (857 , 1115) ∷ (858 , 1117) ∷ (859 , 1119) ∷ (860 , 1121) ∷ (861 , 1123) ∷ (862 , 1125) ∷ (863 , 1127) ∷ (864 , 1129) ∷ (865 , 1131) ∷ (866 , 1133) ∷ (867 , 1135) ∷ (868 , 1137) ∷ (869 , 1139) ∷ (870 , 1141) ∷ (871 , 1143) ∷ (872 , 1145) ∷ (873 , 1147) ∷ (874 , 1149) ∷ (875 , 1151) ∷ (876 , 1153) ∷ (877 , 1155) ∷ (878 , 1157) ∷ (879 , 1159) ∷ (880 , 1161) ∷ (881 , 1163) ∷ (882 , 1165) ∷ (883 , 1167) ∷ (884 , 1169) ∷ (885 , 1171) ∷ (886 , 1173) ∷ (887 , 1175) ∷ (888 , 1177) ∷ (889 , 1179) ∷ (890 , 1181) ∷ (891 , 1183) ∷ (892 , 1185) ∷ (893 , 1187) ∷ (894 , 1189) ∷ (895 , 1191) ∷ (896 , 1193) ∷ (897 , 1195) ∷ (898 , 1197) ∷ (899 , 1199) ∷ (900 , 1201) ∷ []

  in
     run (genMain N test inputAss)
